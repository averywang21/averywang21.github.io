<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rockford 70.3 Training Calendar</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f9fafb;
        }
        .calendar-week {
            scroll-snap-align: start;
        }
        .modal {
            transition: opacity 0.25s ease;
        }
        .modal-content {
            transition: transform 0.25s ease;
        }
    </style>
</head>
<body class="text-gray-700">

    <div class="container mx-auto p-4 sm:p-6 lg:p-8">
        <header class="text-center mb-8">
            <h1 class="text-3xl sm:text-4xl font-bold text-gray-800">Rockford 70.3 Training Plan</h1>
            <p class="mt-2 text-lg text-gray-600">3/23 - 6/14</p>
        </header>

        <div class="flex items-center justify-between mb-6 p-4 bg-white rounded-lg shadow-sm">
            <button id="prev-week" class="px-4 py-2 bg-gray-200 text-gray-700 font-semibold rounded-lg hover:bg-gray-300 transition-colors disabled:opacity-50 disabled:cursor-not-allowed">&larr; Previous</button>
            <h2 id="week-indicator" class="text-xl font-bold text-gray-800 text-center"></h2>
            <button id="next-week" class="px-4 py-2 bg-gray-200 text-gray-700 font-semibold rounded-lg hover:bg-gray-300 transition-colors disabled:opacity-50 disabled:cursor-not-allowed">Next &rarr;</button>
        </div>
        
        <div class="flex flex-wrap justify-center gap-4 mb-8 p-4 bg-white rounded-lg shadow-sm">
            <div class="flex items-center gap-2">
                <span class="w-5 h-5 rounded-full bg-blue-100 border border-blue-200"></span>
                <span class="font-medium text-sm text-blue-800">Swim</span>
            </div>
            <div class="flex items-center gap-2">
                <span class="w-5 h-5 rounded-full bg-green-100 border border-green-200"></span>
                <span class="font-medium text-sm text-green-800">Bike</span>
            </div>
            <div class="flex items-center gap-2">
                <span class="w-5 h-5 rounded-full bg-orange-100 border border-orange-200"></span>
                <span class="font-medium text-sm text-orange-800">Run</span>
            </div>
             <div class="flex items-center gap-2">
                <span class="w-5 h-5 rounded-full bg-purple-200 border border-purple-300"></span>
                <span class="font-medium text-sm text-purple-800">Race/Recovery</span>
            </div>
             <div class="flex items-center gap-2">
                <div class="w-5 h-5 rounded-md border-2 border-dashed border-gray-400"></div>
                <span class="font-medium text-sm text-gray-600">Brick Workout</span>
            </div>
        </div>

        <main id="calendar-container">
            <!-- Calendar will be dynamically generated here -->
        </main>
    </div>

    <!-- Swim Workout Modal -->
    <div id="swim-modal" class="modal fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4 hidden">
        <div class="modal-content bg-white rounded-lg shadow-xl w-full max-w-md p-6 transform scale-95">
            <div class="flex items-center justify-between mb-4">
                <h3 id="modal-title" class="text-lg font-bold text-gray-800">Swim Workout</h3>
                <button id="close-modal-btn" class="text-gray-500 hover:text-gray-800">&times;</button>
            </div>
            <div id="modal-body" class="text-gray-600 space-y-2">
                <!-- Swim workout details will be injected here -->
            </div>
        </div>
    </div>

    <script>
        const swimWorkouts = {
            "#1": "200wu, 6x50drills@10sec, 3x50@10sec, 2x100@20sec, 2x150@30sec, 3x100@20sec, 3x50@10sec, 6x50 drills@10sec, 200cd",
            "#2": "200wu, 6x50drills@10sec, 4x(100@15sec, 150@20sec), 6x50drills@10sec, 200cd",
            "#3": "200wu, 6x50 drills@10sec, 4x(25@5sec, 50@5sec, 75@10sec, 100@15sec), 6x50 drills@10sec, 200cd",
            "#4": "200wu, 6x50 drills@10sec, 2x250@30sec, 4x125@15sec, 6x50drills@10sec, 200cd",
            "#5": "200wu, 6x50 drills@10sec, 3x(100@15sec, 250@30sec), 6x50 drills@10sec, 200cd",
            "#6": "200wu, 6x50drills@10sec, 8x25@5sec, 4x50@10sec, 2x100@15sec, 2x200@20sec, 6x50drills@10sec, 200cd",
            "#7": "200wu, 6x50drills@10sec, 3x(150@15sec, 200@20sec), 6x50drills@10sec, 200cd",
            "#8": "200wu, 6x50 drills@10sec, 3x175@20sec, 3x125@10sec, 6x50 drills@10sec, 200cd",
            "#9": "200wu, 6x50drills@10sec, 500@35sec, 400@30sec, 300@25sec, 200@20sec, 100@15sec, 6x50 drills@10sec, 200cd",
            "#10": "200wu, 6x50drills@10sec, 2x(50@5sec, 100@10sec, 150@15sec, 200@20sec, 250@25sec), 6x50drills@10sec, 200cd",
            "#11": "200wu, 6x50 drills@10sec, 4x(125@15sec, 225@25sec), 6x50 drills@10sec, 200cd",
            "#12": "200wu, 6x50 drills@10sec, 4x25@5sec, 3x75@10sec, 2x125@15sec, 1x250@20sec, 2x125@15sec, 3x75@10sec, 4x25@5sec, 6x50drills@10sec, 200cd",
            "#13": "200wu, 6x50 drills@10sec, 6x150@15sec, 6x100@10sec, 6x50 drills@10sec, 200cd",
            "#14": "200wu, 6x50drills@10sec, 6x250@30sec, 6x50drills@10sec, 200cd",
            "#15": "200wu, 6x50drills@10sec, 3x(25 Fast@15 sec, 125@15 sec), 3x(50 Fast@15sec, 100@15sec), 3x(75 Fast@15 sec, 75@10 sec), 6x50 drills@10sec, 200cd"
        };
        const planData = [
            { week: 1, dates: "Mar 23 - Mar 29", workouts: [
                { day: "M", swim: null, bike: null, run: "Rest Day" },
                { day: "Tu", swim: "#1", bike: null, run: "60 Z2" },
                { day: "W", swim: null, bike: "45 Z2", run: "15 Z2", isBrick: true },
                { day: "Th", swim: "#2", bike: "60 Z2", run: null },
                { day: "F", swim: null, bike: null, run: "Rest Day" },
                { day: "Sa", swim: null, bike: null, run: "1:30 Z1-2" },
                { day: "Su", swim: null, bike: "2:45 Z2", run: "15 Z2", isBrick: true },
            ]},
            { week: 2, dates: "Mar 30 - Apr 5", workouts: [
                { day: "M", swim: null, bike: null, run: "Rest Day" },
                { day: "Tu", swim: "#3", bike: null, run: "60 Z2" },
                { day: "W", swim: null, bike: "45 Z2", run: "15 Z2", isBrick: true },
                { day: "Th", swim: "#4", bike: "60 Z2", run: null },
                { day: "F", swim: null, bike: null, run: "Rest Day" },
                { day: "Sa", swim: null, bike: null, run: "1:45 Z1-2" },
                { day: "Su", swim: null, bike: "3:15 Z2", run: "15 Z2", isBrick: true },
            ]},
            { week: 3, dates: "Apr 6 - Apr 12", workouts: [
                { day: "M", swim: null, bike: null, run: "Rest Day" },
                { day: "Tu", swim: "#5", bike: null, run: "60 Z2" },
                { day: "W", swim: null, bike: "45 Z2", run: "15 Z2", isBrick: true },
                { day: "Th", swim: "#6", bike: "60 Z2", run: null },
                { day: "F", swim: null, bike: null, run: "Rest Day" },
                { day: "Sa", swim: null, bike: null, run: "2:00 Z1-2" },
                { day: "Su", swim: null, bike: "3:45 Z2", run: "15 Z2", isBrick: true },
            ]},
            { week: 4, dates: "Apr 13 - Apr 19", workouts: [
                { day: "M", swim: null, bike: null, run: "Rest Day" },
                { day: "Tu", swim: "#7", bike: null, run: "60 Z2" },
                { day: "W", swim: null, bike: "45 Z2", run: "15 Z2", isBrick: true },
                { day: "Th", swim: "#8", bike: "60 Z2", run: null },
                { day: "F", swim: null, bike: null, run: "Rest Day" },
                { day: "Sa", swim: null, bike: null, run: "2:15 Z1-2" },
                { day: "Su", swim: null, bike: "4:15 Z2", run: "15 Z2", isBrick: true },
            ]},
            { week: 5, dates: "Apr 20 - Apr 26", workouts: [
                { day: "M", swim: null, bike: null, run: "Rest Day" },
                { day: "Tu", swim: "#9", bike: "60 Z2 (at 10, 5x1 PU @ 1 spin)", run: null },
                { day: "W", swim: null, bike: "45 Z2", run: "15 Z2", isBrick: true },
                { day: "Th", swim: "#10", bike: null, run: null },
                { day: "F", swim: "30 easy", bike: null, run: "60 Z1-2 (with 5x1 PU @ 1 jog)" },
                { day: "Sa", swim: null, bike: "30 Z1 (easy) p.m. safety check", run: "30 Z1 (easy) a.m." },
                { day: "Su", special: "B-RACE: St. Anthony's OLY", recovery: "Bike 2:00 Z1-2 recovery"},
            ]},
            { week: 6, dates: "Apr 27 - May 3", workouts: [
                { day: "M", swim: null, bike: null, run: "1:45 Z1-2" },
                { day: "Tu", swim: "#11", bike: null, run: "60 Z2" },
                { day: "W", swim: null, bike: "45 Z2", run: "15 Z2", isBrick: true },
                { day: "Th", swim: "#12", bike: "60 Z2 (at 10, 10x2 Z4 hills @ spin down)", run: null },
                { day: "F", swim: null, bike: null, run: "Rest Day" },
                { day: "Sa", swim: null, bike: "30 Z1 (100+ rpm)", run: "2:15 Z1-2" },
                { day: "Su", swim: null, bike: "3:15 Z2 (at 3:00, 10 Z4)", run: "15 Z2", isBrick: true },
            ]},
            { week: 7, dates: "May 4 - May 10", workouts: [
                { day: "M", swim: null, bike: null, run: "Rest Day" },
                { day: "Tu", swim: "#13", bike: null, run: "60 Z2 (at 45, 10 Z4)" },
                { day: "W", swim: null, bike: "45 Z2", run: "15 Z2", isBrick: true },
                { day: "Th", swim: "#14", bike: "60 Z2 (at 10, 6x4 Z4 @ 2 spin)", run: null },
                { day: "F", swim: null, bike: null, run: "Rest Day" },
                { day: "Sa", swim: null, bike: null, run: "1:45 Z1-2" },
                { day: "Su", swim: null, bike: "4:15 Z2 (at 3:55, 15 Z4)", run: "45 Z2", isBrick: true },
            ]},
            { week: 8, dates: "May 11 - May 17", workouts: [
                { day: "M", swim: null, bike: null, run: "Rest Day" },
                { day: "Tu", swim: "#15", bike: null, run: "60 Z2 (at 10, 8x3 Z4 @ 1.5 jog)" },
                { day: "W", swim: null, bike: "45 Z2", run: "15 Z2", isBrick: true },
                { day: "Th", swim: "#9", bike: "60 Z2", run: null },
                { day: "F", swim: null, bike: null, run: "Rest Day" },
                { day: "Sa", special: "B-RACE: Brooklyn Half Marathon", recovery: null },
                { day: "Su", swim: null, bike: "4:15 Z2", run: "45 Z2", isBrick: true },
            ]},
            { week: 9, dates: "May 18 - May 24", workouts: [
                { day: "M", swim: null, bike: null, run: "Rest Day" },
                { day: "Tu", swim: "#10", bike: null, run: "60 Z2 (at 40, 12.5 Z4)" },
                { day: "W", swim: null, bike: "45 Z2", run: "15 Z2", isBrick: true },
                { day: "Th", swim: "#11", bike: "60 Z2 (at 10, 5x5 Z4 @ 2.5 spin)", run: null },
                { day: "F", swim: null, bike: null, run: "Rest Day" },
                { day: "Sa", swim: null, bike: null, run: "1:45 Z1-2" },
                { day: "Su", swim: null, bike: "4:15 Z2 (at 3:50, 20 Z4)", run: "45 Z2", isBrick: true },
            ]},
            { week: 10, dates: "May 25 - May 31", workouts: [
                { day: "M", swim: null, bike: null, run: "Rest Day" },
                { day: "Tu", swim: "Aquathlon (1500 m)", bike: null, run: "Aquathlon (5k)" },
                { day: "W", swim: null, bike: "45 Z2", run: "15 Z2", isBrick: true },
                { day: "Th", swim: "#13", bike: "60 Z2 (at 10, 8x3 Z4 hills @ spin down)", run: null },
                { day: "F", swim: null, bike: null, run: "Rest Day" },
                { day: "Sa", swim: null, bike: "30 Z1 (100+ rpm)", run: "2:15 Z1-2" },
                { day: "Su", swim: null, bike: "3:15 Z2 (at 2:30, 40 Z3)", run: "15 Z2", isBrick: true },
            ]},
            { week: 11, dates: "June 1 - June 7", workouts: [
                { day: "M", swim: null, bike: null, run: "Rest Day" },
                { day: "Tu", swim: "#14", bike: null, run: "60 Z2 (at 40, 15 Z4)" },
                { day: "W", swim: null, bike: "45 Z2", run: "15 Z2", isBrick: true },
                { day: "Th", swim: "#15", bike: "60 Z2 (at 10, 3x7.5 Z4 @ 3.5 spin)", run: null },
                { day: "F", swim: null, bike: null, run: "Rest Day" },
                { day: "Sa", swim: null, bike: "2:15 Z2", run: "15 Z2", isBrick: true },
                { day: "Su", swim: null, bike: null, run: "Chicago 13.1"},
            ]},
            { week: 12, dates: "June 8 - June 14", workouts: [
                { day: "M", swim: null, bike: null, run: "Rest Day" },
                { day: "Tu", swim: "30 easy", bike: null, run: "45 Z1-2 (at 10, 5x1 PU @ 1 jog)" },
                { day: "W", swim: null, bike: "45 Z1-2", run: "15 Z1-2", isBrick: true },
                { day: "Th", swim: "30 easy", bike: "60 Z1 (at 10, 5x1 PU @ 1 spin)", run: null },
                { day: "F", swim: null, bike: null, run: "40 Z1 (at 10, 5x1 PU @ 1 jog)" },
                { day: "Sa", swim: null, bike: "15 Z1 (bike safety check)", run: "20 Z1"},
                { day: "Su", special: "A-RACE: Rockford 70.3", recovery: "Celebrate!"},
            ]},
        ];

        const container = document.getElementById('calendar-container');

        const parseDuration = (workoutString) => {
            if (!workoutString) return 0;
            const timeMatch = workoutString.match(/^(\d+(?::\d+)?)/);
            if (!timeMatch) return 0;
            
            const timeStr = timeMatch[0];
            if (timeStr.includes(':')) {
                const parts = timeStr.split(':');
                return (parseInt(parts[0], 10) * 60) + parseInt(parts[1], 10);
            }
            const minutes = parseInt(timeStr, 10);
            return isNaN(minutes) ? 0 : minutes;
        };

        planData.forEach(week => {
            let swimTime = 0, bikeTime = 0, runTime = 0;
            week.workouts.forEach(day => {
                if (day.special && day.special.includes("OLY")) { // Approximate OLY race time
                    swimTime += 30; bikeTime += 90; runTime += 60;
                } else if (day.special && day.special.includes("Half Marathon")){
                    runTime += 120; // Approx HM time is 2 hours
                } else if (day.special && day.special.includes("70.3")){
                    swimTime += 45; bikeTime += 180; runTime += 135; // Approx 70.3 time
                }
                else {
                    if (day.swim) {
                        if(day.swim.startsWith('#')) {
                            swimTime += 45;
                        } else if (day.swim.includes("Aquathlon")) {
                            swimTime += 30;
                        } else {
                            swimTime += parseDuration(day.swim);
                        }
                    }
                    if (day.bike) bikeTime += parseDuration(day.bike);
                    if (day.run && day.run !== "Rest Day") {
                         if (day.run.includes("Aquathlon")) {
                            runTime += 30;
                        } else if (day.run.includes("Chicago 13.1")) {
                            runTime += 120;
                        } else {
                            runTime += parseDuration(day.run);
                        }
                    }
                }
                if (day.recovery && day.recovery.toLowerCase().includes('bike')) {
                    bikeTime += parseDuration(day.recovery);
                }
            });
            const totalTime = swimTime + bikeTime + runTime;
            week.totals = {
                swim: (swimTime / 60).toFixed(2),
                bike: (bikeTime / 60).toFixed(2),
                run: (runTime / 60).toFixed(2),
                total: (totalTime / 60).toFixed(2),
            };
        });

        // --- DYNAMIC DATE LOGIC ---
        const planStartDate = new Date('2026-03-23T00:00:00');
        const planEndDate = new Date(planStartDate);
        planEndDate.setDate(planStartDate.getDate() + 12 * 7);
        
        // Use the actual current date
        const today = new Date(); 

        const isWithinPlanDates = today >= planStartDate && today < planEndDate;

        let currentWeekIndex = 0; // Default to week 1
        let currentDayIndex = -1; // Default to no highlight
        
        if (isWithinPlanDates) {
            const msPerDay = 1000 * 60 * 60 * 24;
            const diffTime = today.getTime() - planStartDate.getTime();
            currentWeekIndex = Math.floor(diffTime / (msPerDay * 7));
            // Map JS getDay() [Sun=0, Mon=1...] to our array index [Mon=0, Tue=1...]
            currentDayIndex = (today.getDay() + 6) % 7;
        }
        // --- END DYNAMIC DATE LOGIC ---

        const parseWorkout = (content) => {
            if (!content) return { main: '', detail: '' };
            const match = content.match(/(.*?)\s*\((.*)\)/);
            return match ? { main: match[1].trim(), detail: match[2].trim() } : { main: content, detail: '' };
        };
        
        planData.forEach((weekData, weekIndex) => {
            const weekElement = document.createElement('div');
            weekElement.className = 'bg-white rounded-xl shadow-lg p-4 sm:p-6 calendar-week';
            weekElement.id = `week-${weekData.week}`;

            weekElement.innerHTML = `
                <div class="sm:flex justify-between items-baseline mb-4">
                    <div>
                        <h2 class="text-xl font-bold text-gray-800">Week ${weekData.week}</h2>
                        <p class="text-sm text-gray-500">${weekData.dates}</p>
                    </div>
                    <div class="text-xs sm:text-sm text-gray-600 font-medium mt-2 sm:mt-0 text-left sm:text-right">
                        <span>Total: <span class="font-bold text-gray-800">${weekData.totals.total} hrs</span></span> |
                        <span class="text-blue-600">S: ${weekData.totals.swim}</span> |
                        <span class="text-green-600">B: ${weekData.totals.bike}</span> |
                        <span class="text-orange-600">R: ${weekData.totals.run}</span>
                    </div>
                </div>
            `;
            
            const daysContainer = document.createElement('div');
            daysContainer.className = 'flex flex-row gap-2 sm:gap-3';

            const labelsWrapper = document.createElement('div');
            labelsWrapper.className = 'hidden sm:flex flex-col pt-8 space-y-2'; 
            labelsWrapper.innerHTML = `
                 <div class="h-16 flex items-center justify-end pr-2 font-semibold text-xs text-blue-700">Swim</div>
                 <div class="h-16 flex items-center justify-end pr-2 font-semibold text-xs text-green-700">Bike</div>
                 <div class="h-16 flex items-center justify-end pr-2 font-semibold text-xs text-orange-700">Run</div>
            `;
            daysContainer.appendChild(labelsWrapper);

            const workoutGrid = document.createElement('div');
            workoutGrid.className = 'grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-7 gap-2 sm:gap-3 flex-1';

            const createWorkoutCell = (data, colorBg, colorText, isSwim = false) => {
                 if (!data.main) return `<div class="bg-gray-100 p-2 rounded-md h-16"></div>`;
                 const clickHandler = isSwim && data.main.startsWith('#') ? `onclick="openModal('${data.main}')"` : '';
                 const cursorClass = isSwim && data.main.startsWith('#') ? 'cursor-pointer hover:shadow-md' : '';
                 return `
                    <div class="${colorBg} ${colorText} p-2 rounded-md h-16 flex flex-col items-center justify-center text-center ${cursorClass}" ${clickHandler}>
                        <span class="text-sm font-medium">${data.main}</span>
                        ${data.detail ? `<span class="text-[10px] leading-tight font-normal text-gray-600 mt-1">${data.detail}</span>` : ''}
                    </div>
                 `;
            }

            weekData.workouts.forEach((dayData, dayIndex) => {
                const dayWrapper = document.createElement('div');
                const isCurrentDay = (weekIndex === currentWeekIndex && dayIndex === currentDayIndex);
                
                dayWrapper.className = `flex flex-col gap-2 p-1 rounded-lg ${isCurrentDay ? 'bg-blue-50 border-2 border-blue-300' : ''}`;
                
                let dayContent;
                
                const dayIndicatorHTML = `<div class="font-bold text-center text-sm mb-1 text-gray-600">${dayData.day}</div>`;

                if (dayData.special) {
                    dayContent = `
                        ${dayIndicatorHTML}
                        <div class="flex flex-col justify-center items-center flex-grow gap-2 p-2 rounded-lg bg-purple-200 text-purple-900 text-center h-full">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.539 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.196-1.539-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.783-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z" /></svg>
                            <span class="font-semibold text-sm">${dayData.special}</span>
                            ${dayData.recovery ? `<span class="text-xs mt-1 italic">${dayData.recovery}</span>` : ''}
                        </div>
                    `;
                } else if (dayData.run === 'Rest Day') {
                     dayContent = `
                        ${dayIndicatorHTML}
                        <div class="bg-gray-100 p-2 rounded-md h-16"></div>
                        <div class="bg-gray-100 p-2 rounded-md h-16"></div>
                        <div class="bg-gray-100 p-2 rounded-md h-16"></div>
                    `;
                } else {
                    const swim = parseWorkout(dayData.swim);
                    const bike = parseWorkout(dayData.bike);
                    const run = parseWorkout(dayData.run);
                    
                    const swimCell = createWorkoutCell(swim, 'bg-blue-100', 'text-blue-800', true);
                    const bikeCell = createWorkoutCell(bike, 'bg-green-100', 'text-green-800');
                    const runCell = createWorkoutCell(run, 'bg-orange-100', 'text-orange-800');

                    if(dayData.isBrick) {
                        dayContent = `
                            ${dayIndicatorHTML}
                            ${swimCell}
                            <div class="border-2 border-dashed border-gray-400 rounded-lg space-y-2">
                                ${bikeCell}
                                ${runCell}
                            </div>
                        `;
                    } else {
                        dayContent = `
                            ${dayIndicatorHTML}
                            ${swimCell}
                            ${bikeCell}
                            ${runCell}
                        `;
                    }
                }

                dayWrapper.innerHTML = dayContent;
                workoutGrid.appendChild(dayWrapper);
            });
            
            daysContainer.appendChild(workoutGrid);
            weekElement.appendChild(daysContainer);
            container.appendChild(weekElement);
        });

        // Navigation script
        const weeks = document.querySelectorAll('.calendar-week');
        const prevBtn = document.getElementById('prev-week');
        const nextBtn = document.getElementById('next-week');
        const weekIndicator = document.getElementById('week-indicator');
        
        function updateView() {
            weeks.forEach((week, index) => {
                week.classList.toggle('hidden', index !== currentWeekIndex);
            });

            weekIndicator.textContent = `Week ${planData[currentWeekIndex].week} of 12 (${planData[currentWeekIndex].dates})`;

            prevBtn.disabled = currentWeekIndex === 0;
            nextBtn.disabled = currentWeekIndex === planData.length - 1;
        }

        prevBtn.addEventListener('click', () => {
            if (currentWeekIndex > 0) {
                currentWeekIndex--;
                updateView();
                window.scrollTo(0, 0);
            }
        });

        nextBtn.addEventListener('click', () => {
            if (currentWeekIndex < planData.length - 1) {
                currentWeekIndex++;
                updateView();
                window.scrollTo(0, 0);
            }
        });

        updateView(); // Initial view setup

        // Modal script
        const modal = document.getElementById('swim-modal');
        const modalContent = modal.querySelector('.modal-content');
        const modalTitle = document.getElementById('modal-title');
        const modalBody = document.getElementById('modal-body');
        const closeModalBtn = document.getElementById('close-modal-btn');

        window.openModal = (swimId) => {
            const workoutDetail = swimWorkouts[swimId];
            if (workoutDetail) {
                modalTitle.textContent = `Swim Workout ${swimId}`;
                modalBody.textContent = workoutDetail;
                modal.classList.remove('hidden');
                modal.classList.add('opacity-100');
                modalContent.classList.remove('scale-95');
                modalContent.classList.add('scale-100');
            }
        };

        const closeModal = () => {
            modal.classList.add('opacity-0');
            modalContent.classList.add('scale-95');
            setTimeout(() => {
                modal.classList.add('hidden');
                 modal.classList.remove('opacity-0');
                 modalContent.classList.remove('scale-100');

            }, 250);
        };

        closeModalBtn.addEventListener('click', closeModal);
        modal.addEventListener('click', (e) => {
            if (e.target === modal) {
                closeModal();
            }
        });
    </script>
</body>
</html>

