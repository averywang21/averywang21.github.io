<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>NYC Half Training Calendar</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="min-h-screen bg-slate-950 text-slate-50 px-3 py-4 md:px-6 md:py-8">
    <main class="mx-auto flex max-w-6xl flex-col gap-5 md:gap-6">
      <header class="flex flex-col gap-2 md:gap-3">
        <h1 class="text-2xl md:text-3xl font-bold tracking-tight">
          NYC Half Training Calendar
        </h1>
        <p class="text-sm md:text-base text-slate-300 max-w-2xl">
          Pfitz base build to 40 + Pfitz Half 40-50 plan
        </p>
      </header>

      <div id="legend-root"></div>
      <section
        id="calendar-root"
        class="rounded-2xl bg-slate-900/80 border border-slate-800 p-4 md:p-5 shadow-lg flex flex-col gap-4 md:gap-5"
      ></section>
    </main>

    <script>
      const daysOfWeek = ["Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"];

      const paces = {
        Recovery: "9:00+",
        Aerobic: "8:20-9:30",
        Endurance: "9:00 → 8:00",
        Threshold: "~6:45",
        "VO2 max": "~6:20",
        Progression: "9:00 → 7:00",
      };

      function addDays(dateStr, days) {
        const d = new Date(dateStr + "T00:00:00");
        d.setDate(d.getDate() + days);
        return d;
      }

      function getDateForDay(weekStart, day) {
        const offset = daysOfWeek.indexOf(day);
        return addDays(weekStart, offset);
      }

      function formatDate(date) {
        return date.toLocaleDateString("en-US", { month: "short", day: "numeric" });
      }

      function isSameDay(a, b) {
        return (
          a.getFullYear() === b.getFullYear() &&
          a.getMonth() === b.getMonth() &&
          a.getDate() === b.getDate()
        );
      }

      const workoutColors = {
        Recovery: "#22c55e", // green
        Aerobic: "#0ea5e9", // sky blue
        Endurance: "#eab308", // darker yellow
        Threshold: "#f97316", // orange
        "VO2 max": "#ef4444", // red
        Progression: "#a855f7", // purple
        Race: "#ec4899", // pink
      };

      // Plan loaded from 12/22/2025 – 3/16/2026
      const weeks = [
        {
          start: "2025-12-22",
          totalMiles: 37,
          workouts: [
            { day: "Tue", miles: 6, type: "Aerobic", workoutDetails: "8x100" },
            { day: "Wed", miles: 8, type: "Endurance" },
            { day: "Fri", miles: 8, type: "Threshold", workoutDetails: "14', 12' @ LT" },
            { day: "Sat", miles: 5, type: "Recovery" },
            { day: "Sun", miles: 10, type: "Endurance" },
          ],
        },
        {
          start: "2025-12-29",
          totalMiles: 40,
          workouts: [
            {
              day: "Tue",
              miles: 7,
              type: "Aerobic",
              workoutDetails: "6x12\" hill + 6x100",
            },
            { day: "Wed", miles: 8, type: "Endurance" },
            {
              day: "Fri",
              miles: 9,
              type: "Threshold",
              workoutDetails: "18', 12' @ LT",
            },
            { day: "Sat", miles: 5, type: "Recovery" },
            { day: "Sun", miles: 11, type: "Progression", note: "last 2 mi @ LT" },
          ],
        },
        {
          start: "2026-01-05",
          totalMiles: 43,
          workouts: [
            {
              day: "Tue",
              miles: 8,
              type: "Aerobic",
              workoutDetails: "6x12\" hill + 6x100",
            },
            { day: "Wed", miles: 9, type: "Endurance" },
            {
              day: "Fri",
              miles: 9,
              type: "Threshold",
              workoutDetails: "18', 15' @ LT",
            },
            { day: "Sat", miles: 5, type: "Recovery" },
            { day: "Sun", miles: 12, type: "Endurance" },
          ],
        },
        {
          start: "2026-01-12",
          totalMiles: 37,
          workouts: [
            { day: "Tue", miles: 8, type: "Aerobic", workoutDetails: "2x5x150" },
            { day: "Wed", miles: 7, type: "Aerobic" },
            { day: "Fri", miles: 8, type: "Aerobic" },
            { day: "Sat", miles: 5, type: "Recovery" },
            { day: "Sun", miles: 9, type: "Aerobic" },
          ],
        },
        {
          start: "2026-01-19",
          totalMiles: 44,
          workouts: [
            {
              day: "Tue",
              miles: 7,
              type: "Aerobic",
              workoutDetails: "6x12\" hill + 6x100",
            },
            { day: "Wed", miles: 9, type: "Endurance" },
            {
              day: "Fri",
              miles: 9,
              type: "Threshold",
              workoutDetails: "28' @ LT",
            },
            { day: "Sat", miles: 5, type: "Recovery" },
            {
              day: "Sun",
              miles: 14,
              type: "Progression",
              note: "Fred Lebow HM\nlast 3 mi @ LT",
            },
          ],
        },
        {
          start: "2026-01-26",
          totalMiles: 38,
          workouts: [
            { day: "Tue", miles: 8, type: "Aerobic", workoutDetails: "2x4x150" },
            { day: "Wed", miles: 10, type: "Endurance" },
            { day: "Fri", miles: 7, type: "Aerobic" },
            { day: "Sat", miles: 3, type: "Recovery", workoutDetails: "4x100" },
            { day: "Sun", miles: 10, type: "Race", note: "Manhattan 10k" },
          ],
        },
        {
          start: "2026-02-02",
          totalMiles: 40,
          workouts: [
            { day: "Tue", miles: 8, type: "Aerobic" },
            { day: "Wed", miles: 8, type: "Aerobic" },
            { day: "Fri", miles: 9, type: "Aerobic" },
            { day: "Sat", miles: 5, type: "Recovery" },
            {
              day: "Sun",
              miles: 10,
              type: "Threshold",
              workoutDetails: "20', 16' @ LT",
            },
          ],
        },
        {
          start: "2026-02-09",
          totalMiles: 45,
          workouts: [
            { day: "Tue", miles: 8, type: "Aerobic", workoutDetails: "10x100" },
            { day: "Wed", miles: 10, type: "Endurance" },
            { day: "Fri", miles: 9, type: "Aerobic" },
            { day: "Sat", miles: 5, type: "Recovery" },
            {
              day: "Sun",
              miles: 13,
              type: "Progression",
              note: "last 3 mi @ LT",
            },
          ],
        },
        {
          start: "2026-02-16",
          totalMiles: 48,
          workouts: [
            { day: "Tue", miles: 8, type: "Aerobic" },
            { day: "Wed", miles: 10, type: "Endurance" },
            {
              day: "Fri",
              miles: 10,
              type: "VO2 max",
              workoutDetails: "6x1000 @ 5k",
            },
            { day: "Sat", miles: 4, type: "Recovery" },
            { day: "Sun", miles: 14, type: "Endurance" },
          ],
        },
        {
          start: "2026-02-23",
          totalMiles: 39,
          workouts: [
            { day: "Tue", miles: 8, type: "Aerobic", workoutDetails: "2x4x150" },
            { day: "Wed", miles: 7, type: "Endurance" },
            { day: "Fri", miles: 7, type: "Aerobic" },
            { day: "Sat", miles: 3, type: "Recovery", workoutDetails: "4x100" },
            {
              day: "Sun",
              miles: 14,
              type: "Progression",
              note: "Napa HM\nlast 10k @ HMP",
            },
          ],
        },
        {
          start: "2026-03-02",
          totalMiles: 32,
          workouts: [
            { day: "Tue", miles: 6, type: "Aerobic", workoutDetails: "2x6x100" },
            { day: "Wed", miles: 7, type: "Recovery" },
            {
              day: "Fri",
              miles: 10,
              type: "VO2 max",
              workoutDetails: "2x1200, 4x800 @ 5k",
            },
            { day: "Sat", miles: 3, type: "Recovery" },
            { day: "Sun", miles: 10, type: "Endurance" },
          ],
        },
        {
          start: "2026-03-09",
          totalMiles: 33,
          workouts: [
            {
              day: "Tue",
              miles: 7,
              type: "VO2 max",
              workoutDetails: "4x100 + 2@HMP",
            },
            { day: "Wed", miles: 5, type: "Recovery" },
            { day: "Fri", miles: 4, type: "Recovery" },
            { day: "Sat", miles: 3, type: "Recovery", workoutDetails: "4x100" },
            { day: "Sun", miles: 14, type: "Race", note: "NYC Half" },
          ],
        },
        {
          start: "2026-03-16",
          totalMiles: 16,
          workouts: [
            { day: "Wed", miles: 6, type: "Recovery" },
            { day: "Fri", miles: 4, type: "Recovery", workoutDetails: "4x100" },
            { day: "Sat", miles: 1, type: "Race", note: "Shamrock Mile" },
            { day: "Sun", miles: 5, type: "Race", note: "Shamrock Shuffle 8k" },
          ],
        },
      ];

      function renderLegend() {
        const root = document.getElementById("legend-root");
        let html = `<section class='rounded-2xl bg-slate-900/80 border border-slate-800 p-4 md:p-5 shadow-lg'>`;
        html += `<h2 class='text-base md:text-lg font-semibold mb-3 md:mb-4'>Workout legend</h2>`;
        html += `<div class='grid gap-3 md:gap-4 grid-cols-2 sm:grid-cols-3 lg:grid-cols-4'>`;
        for (const [type, color] of Object.entries(workoutColors)) {
          const pace = paces[type]
            ? `<span class='text-slate-400 text-xs md:text-sm ml-1'>(${paces[type]})</span>`
            : "";
          html += `<div class='flex flex-col'><div class='flex items-center gap-3'><div class='h-5 w-5 rounded-md border border-slate-600' style='background:${color}'></div><span class='text-xs md:text-sm font-semibold text-slate-100'>${type}</span>${pace}</div></div>`;
        }
        html += `</div></section>`;
        root.innerHTML = html;
      }

      function renderCalendar() {
        const root = document.getElementById("calendar-root");
        const today = new Date();
        let html = `<div class='grid gap-1.5 md:gap-2 text-[0.65rem] md:text-xs mb-2 [grid-template-columns:.8fr_1fr_1fr_.8fr_1fr_1fr_1fr]'>`;

        for (const day of daysOfWeek) {
          html += `<div class='text-center font-semibold text-slate-300'>${day}</div>`;
        }
        html += `</div>`;

        weeks.forEach((week) => {
          html += `<div class='flex flex-col gap-1'>`;
          html += `<div class='grid gap-1.5 md:gap-2 [grid-template-columns:.8fr_1fr_1fr_.8fr_1fr_1fr_1fr]'>`;

          for (const day of daysOfWeek) {
            const workout = week.workouts.find((w) => w.day === day);
            const date = getDateForDay(week.start, day);
            const isToday = isSameDay(date, today);
            const borderClass = isToday
              ? "border-amber-400 ring-2 ring-amber-400"
              : "border-slate-800";

            html += `<div class='flex flex-col rounded-xl bg-slate-950/60 border ${borderClass} overflow-hidden min-h-[80px] md:min-h-[96px]'>`;
            html += `<div class='p-1.5 md:p-2 flex flex-col flex-1'>`;
            html += `<div class='flex justify-between mb-1'><span class='text-[0.6rem] md:text-[0.65rem] text-slate-400'>${formatDate(
              date
            )}</span>${
              day === "Mon"
                ? `<span class='text-[0.6rem] md:text-[0.65rem] text-slate-500'>${week.totalMiles} mi</span>`
                : ""
            }</div>`;

            if (workout) {
              const color = workoutColors[workout.type] || "#020617";
              html += `<div class='flex-1 rounded-lg p-1.5 md:p-2 text-[0.65rem] md:text-[0.75rem]' style='background:${color}'><p class='font-semibold'>${
                workout.miles || ""
              } mi · ${workout.type}</p>${
                workout.workoutDetails
                  ? `<p>${workout.workoutDetails}</p>`
                  : ""
              }${
                workout.note
                  ? `<p class='font-medium whitespace-pre-line'>${workout.note}</p>`
                  : ""
              }</div>`;
            } else {
              html += `<div class='flex-1 flex items-center justify-center text-[0.6rem] md:text-[0.65rem] text-slate-500 italic'>Rest / cross-train</div>`;
            }

            html += `</div></div>`;
          }
          html += `</div></div>`;
        });

        root.innerHTML = html;
      }

      renderLegend();
      renderCalendar();
    </script>
  </body>
</html>
